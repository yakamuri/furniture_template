var game=function(){function a(){f=["assets/images/img_01.jpg","assets/images/img_02.jpg","assets/images/img_03.jpg","assets/images/img_04.jpg","assets/images/img_05.jpg","assets/images/img_06.jpg","assets/images/img_07.jpg","assets/images/img_08.jpg","assets/images/img_09.jpg","assets/images/img_10.jpg","assets/images/img_11.jpg","assets/images/img_12.jpg","assets/images/img_13.jpg","assets/images/img_14.jpg","assets/images/img_15.jpg","assets/images/img_16.jpg","assets/images/img_17.jpg","assets/images/img_18.jpg","assets/images/img_01.jpg","assets/images/img_02.jpg","assets/images/img_03.jpg","assets/images/img_04.jpg","assets/images/img_05.jpg","assets/images/img_06.jpg","assets/images/img_07.jpg","assets/images/img_08.jpg","assets/images/img_09.jpg","assets/images/img_10.jpg","assets/images/img_11.jpg","assets/images/img_12.jpg","assets/images/img_13.jpg","assets/images/img_14.jpg","assets/images/img_15.jpg","assets/images/img_16.jpg","assets/images/img_17.jpg","assets/images/img_18.jpg"],c=document.getElementById("visibleCanvas"),d=c.getContext("2d"),r(6,6),s(),q(),p.length=0,u()}function b(){document.addEventListener("gameStart",a,!1)}var c={},d={},e=100,f=[],g={},h={},i={},j=0,k={},l=[],m={},n={},o=1,p=[],q=function(){for(var a=0;a<6;a++)for(var b=0;b<6;b++)d.beginPath(),d.fillStyle="rgb(0,"+Math.floor(255-42.5*b)+","+Math.floor(255-42.5*a)+")",d.fillRect(a*e,b*e,e,e),k={x:a*e,y:b*e,sourceImg:f.pop(),color:"rgb(0,"+Math.floor(255-42.5*b)+","+Math.floor(255-42.5*a)+")"},l[a][b]=k},r=function(a,b){l=[];for(var c=0;c<a;c++){l[c]=[];for(var d=0;d<b;d++)l[c][d]=""}},s=function(){function a(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a}f=a(f)},t=function(){if(o++,19===o){var b=new CustomEvent("gameStop");document.dispatchEvent(b);var c=new CustomEvent("timerStop");document.dispatchEvent(c),a(),$(".score").css("visibility","visible"),$(".game").css("visibility","hidden"),o=1}},u=function(){$(c).unbind("click").on("click",function(a){function b(){p.includes(k)===!1&&(d.drawImage(g,c*e,f*e,e,e),setTimeout(function(){0===j?(m=k,h=m.sourceImg.slice(-6,-4),j=1):1===j&&(n=k,i=n.sourceImg.slice(-6,-4),j=0,h!==i||m.x===n.x&&m.y===n.y?(d.beginPath(),d.fillStyle=m.color,d.fillRect(m.x,m.y,e,e),d.beginPath(),d.fillStyle=n.color,d.fillRect(n.x,n.y,e,e)):(d.beginPath(),d.fillStyle="rgb(199, 188, 86)",d.fillRect(m.x,m.y,e,e),d.beginPath(),d.fillStyle="rgb(199, 188, 86)",d.fillRect(n.x,n.y,e,e),t(),p.push(m),p.push(n)))},200))}var c=parseInt(a.offsetX/e),f=parseInt(a.offsetY/e),k=l[c][f];d.beginPath(),g=new Image,g.addEventListener("load",function(){b()},!1),g.src=k.sourceImg})},v=function(){b()};return{init:v}}();$(document).ready(function(){game.init()});var start_screen=function(){function a(){document.addEventListener("clearTimer",c,!1),document.addEventListener("saveName",b,!1)}var b=function(a){return a.detail},c=function(){$(".overlay .wrapper .start").unbind("click").on("click",function(){$(".overlay").css("visibility","hidden"),$(".game").css("visibility","visible");var a=new CustomEvent("gameStart");document.dispatchEvent(a)})},d=function(){a(),c()};return{init:d}}();$(document).ready(function(){start_screen.init()});var Timer=function(){var a,b=$("h1")[0],c=$("#start"),d=$("#pause"),e=$("#clear"),f=0,g=0,h=0,i=function(){f++,f>=60&&(f=0,g++,g>=60&&(g=0,h++)),b.textContent=(h?h>9?h:"0"+h:"00")+":"+(g?g>9?g:"0"+g:"00")+":"+(f>9?f:"0"+f),j()},j=function(){a=setTimeout(i,1e3)},k=function(){$("#start").css("visibility","hidden"),$("#visibleCanvas").css("pointer-events","initial")},l=function(){$("#start").css("visibility","visible"),$("#visibleCanvas").css("pointer-events","none")},m=function(){clearTimeout(a)},n=function(){b.textContent="00:00:00",f=0,g=0,h=0},o=function(){c.unbind("click").on("click",function(){j(),k()}),d.unbind("click").on("click",function(){clearTimeout(a),l()}),e.unbind("click").on("click",function(){n()})},p=function(){j(),o()},q=function(){document.addEventListener("timerStop",m,!1),document.addEventListener("gameStart",p,!1),document.addEventListener("clearTimer",n,!1)},r=function(){q()};return{init:r}}(),loaded=0;$(document).ready(function(){0===loaded&&(Timer.init(),loaded=1)});var scoreSaver=function(){function a(){document.addEventListener("gameStop",e,!1),document.addEventListener("gameStart",f,!1)}var b=function(a){var b=a,c=b.split(":"),d=60*+c[0]*60+60*+c[1]+ +c[2];return d},c=function(a){var c=a.sort(function(a,c){return b(a.time)-b(c.time)});return c},d=function(a){for(var b=c(a),d=0;d<b.length&&10!==d;d++){var e=b[d].name,f=b[d].time;"undefined"===b&&"null"===b||$(".score .wrapper ul").append("<li>"+(d+1)+"."+e+"<span>"+f+"</span></li>")}},e=function(a,b){if(localStorage){var c=new CustomEvent("saveName",{detail:$(".register .input").val()});document.dispatchEvent(c),a=c.detail;var e=new CustomEvent("timerStop");document.dispatchEvent(e),b=$("#d-timer h1").text(),console.log("user time: "+b+a);var f=JSON.parse(localStorage.getItem("scoreInfo"))||[];f.push({name:a,time:b}),localStorage.setItem("scoreInfo",JSON.stringify(f)),$(".score .wrapper ul li").remove(),d(f)}},f=function(){$(".play_again").unbind().on("click",function(){var a=new CustomEvent("clearTimer");document.dispatchEvent(a),$(".score").css("visibility","hidden"),$(".overlay").css("visibility","visible")})},g=function(){a(),f()};return{init:g}}();$(document).ready(function(){scoreSaver.init()});